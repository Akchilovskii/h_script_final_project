<<<<<<< HEAD
#include"tcpserver.h"
#include"script_interpretor.h"
=======
#include<iostream>
#include"htmlElement.h"  //htmlä¸»ç±»
#include"html_doc.h" //html è¾…åŠ©ç±»
#include"string_processor.h" //æ–‡å­—å¤„ç†å·¥å…·ï¼Œ åŒ…æ‹¬ä¸»è¦ä¸ºå­—ç¬¦ä¸²åˆ†å‰²ä¿æŠ¤å™¨
#include"script_interpretor.h"//è„šæœ¬è§£é‡Šç±»
>>>>>>> a79583aad532b57d2c5163f548efeef6db657598
#include<string>


using namespace std;

string keyboard_input(const char end_char)
{
	char i = 0;
	string result;
	cin >> noskipws;
	while (i != end_char)
	{
		cin >> i;
		if (i == '\n')
			continue;
		result += i;
	}
	cin >> skipws;
	result.pop_back();
	return result;
}

int main()
{
	TcpServer my_server(9190);
	auto client = my_server.Accept();
	if (!client)
	{
		cout << "invalid socket connect" << endl;
	}
	char message[20] = { 0 };
	SOCKET s = client->GetSocket();
	int len=recv(s, message, 20, 0);
	cout << message << endl;
	//½Å±¾½âÊÍÆ÷
	script_interpretor si;
	try
	{
<<<<<<< HEAD
		
		/*                                  ***********¼òµ¥µÄÊ¹ÓÃ·½·¨**************
		    ¡°.¡± ÊÇ×Ö·û·Ö¸î·ûºÅ£¬µ«·ÅÔÚË«ÒıºÅÖĞÎŞĞ§£¨²»Æğ·Ö¸î×÷ÓÃ£©£¬Í¬Ê±¸Ã·ûºÅÄÜ¶¨Î»Ç°Ò»¸öÔªËØÏÂµÄÃû×ÖÎªµ±Ç°ÔªËØµÄhtml±êÇ©£¬Èç¹û²»´æÔÚ¸Ã±êÇ©£¬
			¾Í»á×Ô¶¯´´½¨¸Ã±êÇ©
			¡°[]¡± ÊÇÔªËØÑ¡ÔñÆ÷£¬ ¿ÉÒÔÒÔ¶ººÅ·Ö¸ô£¬ÔÚÆäÖĞÌîÈëÕûÊı£¬ »áÈ·ÇĞÑ¡ÔñÇ°Ò»¸öÔªËØÏÂµÄµÚ¼¸¸ö£¬»òÄ³¼¸¸öÃû×ÖÎªµ±Ç°ÔªËØµÄhtml±êÇ©£¬Óë¡°.¡±½áºÏÊ±£¬
			Èç¹û²»´æÔÚ¸Ã±êÇ©£¬Ôò»á´´½¨·ûºÏÒªÇó¸öÊıµÄ±êÇ©£¬ÀıÈçi[1],»á´´½¨Á½¸öi±êÇ©£¬ÎªÁËÂú×ãÄÜ·ÃÎÊi[1]µÄĞèÇó£¬ ¸Ã·ûºÅ¿ÉÒÔÑ¡Ôñ¶à¸ö±êÇ©£¬ »áÎªÃ¿¸ö±êÇ©´´½¨
			Ò»¸ö½Å±¾Àú³Ì£¬ĞèÒª×¢ÒâµÄÊÇÃ¿´Î¶¼»á¶¨Î»µ½×îºóÒ»¸öÑ¡ÔñµÄ±êÇ©
			¡°=¡± ±íÊ¾ÎªÇ°Ò»¸ö±êÇ©µÄÄ³ÏîÊôĞÔ¸³Öµ£¬Óë¡°.¡±½áºÏ£¬²»´æÔÚ¸ÃÊôĞÔÊ±£¬»á×Ô¶¯Ìí¼Ó¸ÃÊôĞÔ£¬¿ÉÒÔÊ¹ÓÃ»òÕß²»Ê¹ÓÃË«ÒıºÅ£¬µ±ÊôĞÔÖµ°üº¬¡°.¡±Ê±£¬ÇëÊ¹ÓÃË«ÒıºÅ£¬
			Ë«ÒıºÅ²»ÍêÕû½«Òı·¢Òì³£
			¡°text¡±¹Ø¼ü×Ö£¬±íÊ¾Îª±êÇ©ÄÚµÄinnerhtml¸³Öµ£¬¡°single¡±¹Ø¼ü×Ö±íÊ¾¸ÃÔªËØÎªµ¥±êÇ©ÔªËØ
			¡°>>¡±·ûºÅ¹ö¶¯ÖÁÍ¬Ä¿Â¼ÏÂ£¬ÏÂÒ»¸öÍ¬Ãû±êÇ©
			¡°<¡±·ûºÅ·µ»ØÉÏÒ»¼¶Ä¿Â¼
=======
		script_interpretor si; //è„šæœ¬è§£é‡Šå™¨
		/*                                  ***********ç®€å•çš„ä½¿ç”¨æ–¹æ³•**************
		        â€œ.â€ æ˜¯å­—ç¬¦åˆ†å‰²ç¬¦å·ï¼Œä½†æ”¾åœ¨åŒå¼•å·ä¸­æ— æ•ˆï¼ˆä¸èµ·åˆ†å‰²ä½œç”¨ï¼‰ï¼ŒåŒæ—¶è¯¥ç¬¦å·èƒ½å®šä½å‰ä¸€ä¸ªå…ƒç´ ä¸‹çš„åå­—ä¸ºå½“å‰å…ƒç´ çš„htmlæ ‡ç­¾ï¼Œå¦‚æœä¸å­˜åœ¨è¯¥æ ‡ç­¾ï¼Œ
			å°±ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥æ ‡ç­¾
			â€œ[]â€ æ˜¯å…ƒç´ é€‰æ‹©å™¨ï¼Œ å¯ä»¥ä»¥é€—å·åˆ†éš”ï¼Œåœ¨å…¶ä¸­å¡«å…¥æ•´æ•°ï¼Œ ä¼šç¡®åˆ‡é€‰æ‹©å‰ä¸€ä¸ªå…ƒç´ ä¸‹çš„ç¬¬å‡ ä¸ªï¼Œæˆ–æŸå‡ ä¸ªåå­—ä¸ºå½“å‰å…ƒç´ çš„htmlæ ‡ç­¾ï¼Œä¸â€œ.â€ç»“åˆæ—¶ï¼Œ
			å¦‚æœä¸å­˜åœ¨è¯¥æ ‡ç­¾ï¼Œåˆ™ä¼šåˆ›å»ºç¬¦åˆè¦æ±‚ä¸ªæ•°çš„æ ‡ç­¾ï¼Œä¾‹å¦‚i[1],ä¼šåˆ›å»ºä¸¤ä¸ªiæ ‡ç­¾ï¼Œä¸ºäº†æ»¡è¶³èƒ½è®¿é—®i[1]çš„éœ€æ±‚ï¼Œ è¯¥ç¬¦å·å¯ä»¥é€‰æ‹©å¤šä¸ªæ ‡ç­¾ï¼Œ ä¼šä¸ºæ¯ä¸ªæ ‡ç­¾åˆ›å»º
			ä¸€ä¸ªè„šæœ¬å†ç¨‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ¯æ¬¡éƒ½ä¼šå®šä½åˆ°æœ€åä¸€ä¸ªé€‰æ‹©çš„æ ‡ç­¾
			â€œ=â€ è¡¨ç¤ºä¸ºå‰ä¸€ä¸ªæ ‡ç­¾çš„æŸé¡¹å±æ€§èµ‹å€¼ï¼Œä¸â€œ.â€ç»“åˆï¼Œä¸å­˜åœ¨è¯¥å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ è¯¥å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨åŒå¼•å·ï¼Œå½“å±æ€§å€¼åŒ…å«â€œ.â€æ—¶ï¼Œè¯·ä½¿ç”¨åŒå¼•å·ï¼Œ
			åŒå¼•å·ä¸å®Œæ•´å°†å¼•å‘å¼‚å¸¸
			â€œtextâ€å…³é”®å­—ï¼Œè¡¨ç¤ºä¸ºæ ‡ç­¾å†…çš„innerhtmlèµ‹å€¼ï¼Œâ€œsingleâ€å…³é”®å­—è¡¨ç¤ºè¯¥å…ƒç´ ä¸ºå•æ ‡ç­¾å…ƒç´ 
			â€œ>>â€ç¬¦å·æ»šåŠ¨è‡³åŒç›®å½•ä¸‹ï¼Œä¸‹ä¸€ä¸ªåŒåæ ‡ç­¾
			â€œ<â€ç¬¦å·è¿”å›ä¸Šä¸€çº§ç›®å½•
>>>>>>> a79583aad532b57d2c5163f548efeef6db657598
		*/
		string cmdline;
		while ((cmdline = keyboard_input(';')) != "quit")
		{
			si.script(cmdline);
			cout << si.show_html_code();
		}
		//si.script(">>.text = for you");
		//si.script("for i(0,2) in 2html : i.text = hello world");
		
	}
	catch (const char * e) //æŠ›å‡ºå­—ç¬¦ä¸²å¸¸é‡ï¼Œè¯·å‹¿æ¨¡ä»¿ã€‚ã€‚ã€‚ã€‚
	{
		cout << si.show_html_code();
		cout << e;
		return -1;
	}
	
}
